--- a/mm/gup.c
+++ b/mm/gup.c
@@ -1727,7 +1727,7 @@ static int gup_pud_range(p4d_t p4d, unsi
 		next = pud_addr_end(addr, end);
 		if (pud_none(pud))
 			return 0;
-		if (unlikely(pud_huge(pud))) {
+		if (unlikely(pud_huge(pud) || pud_devmap(pud))) {
 			if (!gup_huge_pud(pud, pudp, addr, next, write,
 					  pages, nr))
 				return 0;
